<h3 class="mb-3">Đặt lại mật khẩu</h3>
<p>
  Mã OTP đã gửi đến email: <strong><%= email %></strong>.
  Mã có hiệu lực trong <span id="otp-countdown">60</span> giây.
</p>

<% if (typeof error !== "undefined" && error) { %>
  <div class="alert alert-danger"><%= error %></div>
<% } %>

<form method="post" action="/auth/reset-password" class="col-md-5" id="otp-reset-form">
  <div class="mb-3">
    <label class="form-label">Mã OTP (6 số)</label>
    <input type="text" name="otp" class="form-control" maxlength="6" required>
  </div>

  <div class="mb-3">
    <label class="form-label">Mật khẩu mới</label>
    <div class="input-group">
      <input
        type="password"
        name="newPassword"
        id="reset-new-password"
        class="form-control"
        required
      >
      <button
        type="button"
        class="btn btn-outline-secondary toggle-password"
        data-target="#reset-new-password"
      >
        <i class="bi bi-eye"></i>
      </button>
    </div>
  </div>

  <div class="mb-3">
    <label class="form-label">Xác nhận mật khẩu mới</label>
    <div class="input-group">
      <input
        type="password"
        name="confirmPassword"
        id="reset-confirm-password"
        class="form-control"
        required
      >
      <button
        type="button"
        class="btn btn-outline-secondary toggle-password"
        data-target="#reset-confirm-password"
      >
        <i class="bi bi-eye"></i>
      </button>
    </div>
  </div>

  <button type="submit" class="btn btn-success" id="otp-reset-submit">
    Cập nhật mật khẩu
  </button>
</form>

<script>
  (function () {
    var seconds = 60;
    var span = document.getElementById("otp-countdown");
    var btn = document.getElementById("otp-reset-submit");

    var timer = setInterval(function () {
      seconds--;
      if (span) span.textContent = seconds;

      if (seconds <= 0) {
        clearInterval(timer);
        if (span) span.textContent = "0";
        if (btn) {
          btn.disabled = true;
          btn.textContent = "Mã OTP đã hết hạn";
        }
      }
    }, 1000);
  })();
</script>
